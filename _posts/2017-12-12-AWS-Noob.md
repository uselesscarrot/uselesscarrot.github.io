---
title: AWS로 워드프레스 띄우기
updated: 2017-12-12
---

# AWS로 워드프레스 띄우기

> 본 포스팅은 <예제를 통해 쉽게 따라하는 아마존 웹 서비스>를 참고하여 작성하였습니다.

AWS에 실제로 인스턴스를 띄워서 사용해본 것은 지난 여름에 티켓예매 알림용 텔레그램 봇을 만들었을 때가 처음이자 마지막입니다. 당시에는 VPC, 서브넷, EIP, AMI 등의 개념들을 잘 모른 채로 진행했고 IP들도 책에 나온 그대로 입력했었는데요(적당히 입력하라는 말에 '적당히' 입력을 못해서 자꾸 범위에서 벗어난 IP주소를 잡으려고도 하고 그랬습니다). 이번에는 네트워크 분야의 생경한 단어와 그 개념들에 대해 꼼꼼하게 짚어가며 작성해보겠습니다.    

## 만들고자 하는 AWS의 서비스들과 그 구조

![만들고자 하는 AWS의 서비스들과 그 구조](https://uselesscarrot.github.io/assets/aws-noob-arch.png)   
*※ NAT Gateway는 논리적으로 Public subnet내에 존재하는 객체지만 흐름 표시를 위해 VPC 외부 객체로 표현되었습니다.*
   
책에선 위와 같은 구조의 서비스를 만드는 것을 목표로 합니다. 저도 함께 따라해보겠습니다.

---


## IAM
   
IAM은 AWS 계정과 관련된 권한을 제어하고, 사용자를 관리하는 기능을 제공합니다.   
사용자가 "EC2 인스턴스 생성"을 요청하면 API Call로 AWS에 전달되며, AWS는 사용자를 인증하고 권한을 부여하게 됩니다. 이때 IAM 객체는 IAM User, IAM Group, IAM Role 로 사용자를 정의하고, IAM Policy로 각 사용자의 권한을 정의합니다. 사용자와 권한은 1:N으로 매핑됩니다.   

### Root 계정과 IAM 객체
   
처음 만든 계정을 Root라고 부르고 계정 내에서 할 수 있는 모든 행위에 대한 권한을 갖고 있습니다. 지금은 저 개인이 혼자서 저만 쓰는 워드프레스 페이지를 띄우게 되겠지만, 프로젝트를 진행하다보면 다양한 롤을 가진 사람이 수행업무를 나눠갖고 그에 따른 최소한의 권한만 가지게 될겁니다. 그 때 필요한 것이 IAM이며 하나의 계정 내에 분리된 하나의 사용자 단위를 IAM User라고 부릅니다. 그 User들의 집합을 IAM Group이라고 부르고 User는 다수의 Group에 들어갈 수 있습니다. Role의 경우는 믿을 수 있는 객체가 API Call이 필요할 때 STS 서비스에 임시키를 요청하면, STS 서비스는 해당 객체가 믿을만한지 확인하고 임시키를 발급합니다. 시간이 지나면 해당 임시키는 만료가 되기 때문에 IAM User가 사용하는 영구 인증키쌍에 비해 보안성이 높습니다. 임시키를 발급받은 객체는 임시키쌍을 이용하여 API Call을 수행합니다.   
IAM Policy는 위에 언급한 User, Group, Role의 권한을 정의하는 객체입니다. JSON 포맷을 사용하며 '사용자 범위', '위치', '리스팅, 업로드, 다운로드의 작업', '허용/거부 여부', '조건'등의 항목을 정하여 정책을 구성합니다.  
   
#### Cloudtrail 만들기
![Cloudtrail 만들기](https://uselesscarrot.github.io/assets/aws-noob-cloudtrail.png)
   
**Cloudtrail**은 해당 AWS 계정에서 수신된 모든 API Call을 기록, 수집하는 서비스로 계정 생성 직후에 활성화 하는 것이 좋으며, Raw Data는 S3 버킷 안에 객체 형태로 저장 됩니다. 사용자, 리전, 이벤트 이름, 시간, 사용자 IP 등의 정보를 담고 있습니다.   
* 특정 AWS 서비스의 경우 로깅 범위에서 제외되기도 함.
* S3에 저장되기 때문에 해당 버킷에 권한이 있는 사용자가 로그를 변조할 가능성도 있음. 단 Hash값을 별도로 저장할 수 있으니, AWS-CLI에서의 validate-logs등의 명령으로 무결성 검증 가능.

#### Config 설정



